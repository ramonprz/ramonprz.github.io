---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import MenuBar from '../../components/MenuBar.astro';

export async function getStaticPaths() {
  const posts = await getCollection('posts');
  return posts.map(post => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await post.render();
---

<MenuBar />
<Layout title={post.data.title}>
  <main class="container mx-auto px-4 py-8">
    <nav class="text-sm breadcrumbs mb-6">
        <ul>
          <li><a href="/">Home</a></li>
          <li><a href="/read">Read</a></li>
          <li>{post.data.title}</li>
        </ul>
      </nav>
    <article class="prose lg:prose-xl mx-auto">
      <h1>{post.data.title}</h1>
      <img src={post.data.image.url} alt={post.data.image.alt} class="w-full h-64 object-cover rounded-lg mb-6">
      <div class="flex items-center justify-between mb-6">
        <span class="text-sm text-gray-500">{post.data.readingTime} min read</span>
        <span class="text-sm text-gray-500">{post.data.pubDate.toLocaleDateString()}</span>
      </div>
      <div class="flex flex-wrap gap-2 mb-6">
        {post.data.tags.map((tag) => (
          <span class="bg-blue-100 text-blue-800 text-xs font-semibold px-2.5 py-0.5 rounded">
            {tag}
          </span>
        ))}
      </div>
      <Content />
    </article>
  </main>
</Layout>

<style>
    .breadcrumbs ul {
      display: flex;
      list-style: none;
      padding: 0;
    }
    .breadcrumbs li:not(:last-child)::after {
      content: ">";
      margin: 0 0.5rem;
    }
    .breadcrumbs a {
      color: #3182ce;
      text-decoration: none;
    }
    .breadcrumbs a:hover {
      text-decoration: underline;
    }
  </style>